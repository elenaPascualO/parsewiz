<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataToolkit - Convert JSON, CSV, Excel</title>
    <link rel="stylesheet" href="styles.css">
    <script defer src="https://cloud.umami.is/script.js" data-website-id="f7b7bff8-82b0-499a-ae70-2d940d96a6fa"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>DataToolkit</h1>
            <p class="subtitle">Convert your data files instantly</p>
        </header>

        <main>
            <!-- Upload Section -->
            <section id="upload-section" class="upload-section">
                <div id="drop-zone" class="drop-zone">
                    <div class="drop-zone-content">
                        <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        <p class="drop-text">Drop your file here</p>
                        <p class="drop-subtext">JSON, CSV or Excel</p>
                        <span class="drop-divider">or</span>
                        <label class="file-button">
                            Select file
                            <input type="file" id="file-input" accept=".json,.csv,.xlsx,.xls" hidden>
                        </label>
                    </div>
                </div>
            </section>

            <!-- Raw Editor Section (shown when file parsing fails) -->
            <section id="editor-section" class="editor-section hidden">
                <div class="file-info">
                    <span id="editor-file-name" class="file-name"></span>
                    <span id="editor-file-type" class="file-type"></span>
                </div>

                <div class="editor-error">
                    <p id="editor-error-text"></p>
                </div>

                <div class="editor-container">
                    <div class="editor-line-numbers" id="line-numbers"></div>
                    <textarea id="raw-editor" class="raw-editor" spellcheck="false"></textarea>
                </div>

                <div class="editor-actions">
                    <button id="retry-parse-button" class="retry-btn">Retry Parse</button>
                    <button id="editor-reset-button" class="reset-button">Start Over</button>
                </div>
            </section>

            <!-- Export Mode Selection (shown for complex JSON) -->
            <section id="export-mode-section" class="export-mode-section hidden">
                <div class="mode-card">
                    <h3>Complex JSON Detected</h3>
                    <p id="complexity-info" class="complexity-info"></p>
                    <p class="mode-next-step">In the next step, you can preview and compare two export options: <strong>Multiple Tables</strong> (one table per data type) or <strong>Single Compact Row</strong> (arrays as JSON text).</p>
                    <p class="mode-tip">ðŸ’¡ <strong>Tip:</strong> In Multiple Tables mode, a <code>_record_id</code> column is automatically added to help you link related records across different tables.</p>

                    <div class="mode-actions">
                        <button id="proceed-export-mode" class="proceed-btn">Next</button>
                        <button id="cancel-export-mode" class="cancel-btn">Cancel</button>
                    </div>
                </div>
            </section>

            <!-- Preview Section (hidden by default) -->
            <section id="preview-section" class="preview-section hidden">
                <div class="file-info">
                    <span id="file-name" class="file-name"></span>
                    <span id="file-type" class="file-type"></span>
                </div>

                <div class="preview-header">
                    <h2>Preview</h2>
                    <span id="row-count" class="row-count"></span>
                </div>

                <!-- Mode Toggle (only shown for complex JSON) -->
                <div id="preview-mode-toggle" class="preview-mode-toggle hidden">
                    <button id="btn-multi-file" class="mode-btn active" data-mode="multi">
                        <svg class="mode-btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"/>
                            <rect x="14" y="3" width="7" height="7"/>
                            <rect x="14" y="14" width="7" height="7"/>
                            <rect x="3" y="14" width="7" height="7"/>
                        </svg>
                        Multi-file
                    </button>
                    <button id="btn-single-file" class="mode-btn" data-mode="single">
                        <svg class="mode-btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                            <line x1="3" y1="9" x2="21" y2="9"/>
                            <line x1="9" y1="21" x2="9" y2="9"/>
                        </svg>
                        Single-file
                    </button>
                </div>

                <!-- Multi-table Accordion (shown in multi-file mode) -->
                <div id="multi-table-accordion" class="multi-table-accordion hidden">
                    <!-- Dynamically populated with table previews -->
                </div>

                <p class="table-hint">ðŸ’¡ Hover over cells to view full content</p>

                <div class="pagination-controls">
                    <button id="prev-page" class="pagination-btn" disabled>Previous</button>
                    <span id="page-info" class="page-info">Page 1 of 1</span>
                    <button id="next-page" class="pagination-btn" disabled>Next</button>
                </div>

                <div class="table-container">
                    <table id="preview-table">
                        <thead id="table-head"></thead>
                        <tbody id="table-body"></tbody>
                    </table>
                </div>

                <div class="convert-section">
                    <p class="convert-label">Convert to:</p>
                    <div id="convert-buttons" class="convert-buttons"></div>
                </div>

                <button id="reset-button" class="reset-button">Start Over</button>
            </section>

            <!-- Loading Overlay -->
            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <p>Processing...</p>
            </div>

            <!-- Error Message -->
            <div id="error-message" class="error-message hidden"></div>
        </main>

        <footer>
            <!-- Privacy Disclaimer -->
            <div class="disclaimer">
                <p>Your privacy matters. Files are processed in memory and never stored on our servers.</p>
            </div>

            <!-- Feedback Form -->
            <div class="feedback-section">
                <button id="feedback-toggle" class="feedback-toggle">Send Feedback</button>
                <div id="feedback-form-container" class="feedback-form-container hidden">
                    <form id="feedback-form" class="feedback-form">
                        <input
                            type="email"
                            id="feedback-email"
                            placeholder="Email (optional)"
                            class="feedback-input"
                        >
                        <textarea
                            id="feedback-message"
                            placeholder="Your feedback..."
                            class="feedback-textarea"
                            required
                        ></textarea>
                        <button type="submit" class="feedback-submit">Send</button>
                    </form>
                </div>
            </div>

            <p>DataToolkit &copy; 2026</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
